<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>PenguinBudget - Smart Personal Finance Tracker</title>

  <!-- Link external stylesheet -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="bg-animation"></div>

  <!-- Cute Penguin Decorations -->
  <div class="penguin-corner top-left">
    <svg class="penguin-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="70" rx="25" ry="28" fill="#1a1a1a"/>
      <ellipse cx="50" cy="70" rx="20" ry="23" fill="#ffffff"/>
      <ellipse cx="50" cy="40" rx="20" ry="22" fill="#1a1a1a"/>
      <ellipse cx="42" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="58" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="42" cy="39" rx="2" ry="3" fill="#000000"/>
      <ellipse cx="58" cy="39" rx="2" ry="3" fill="#000000"/>
      <polygon points="50,45 47,50 53,50" fill="#FFD700"/>
      <ellipse cx="35" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(-20 35 60)"/>
      <ellipse cx="65" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(20 65 60)"/>
      <ellipse cx="45" cy="85" rx="6" ry="4" fill="#FFD700"/>
      <ellipse cx="55" cy="85" rx="6" ry="4" fill="#FFD700"/>
    </svg>
  </div>

  <div class="penguin-corner bottom-right">
    <svg class="penguin-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="70" rx="25" ry="28" fill="#1a1a1a"/>
      <ellipse cx="50" cy="70" rx="20" ry="23" fill="#ffffff"/>
      <ellipse cx="50" cy="40" rx="20" ry="22" fill="#1a1a1a"/>
      <ellipse cx="42" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="58" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="42" cy="39" rx="2" ry="3" fill="#000000"/>
      <ellipse cx="58" cy="39" rx="2" ry="3" fill="#000000"/>
      <polygon points="50,45 47,50 53,50" fill="#FFD700"/>
      <ellipse cx="35" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(-20 35 60)"/>
      <ellipse cx="65" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(20 65 60)"/>
      <ellipse cx="45" cy="85" rx="6" ry="4" fill="#FFD700"/>
      <ellipse cx="55" cy="85" rx="6" ry="4" fill="#FFD700"/>
    </svg>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p style="color: var(--gold);">Loading...</p>
    </div>
  </div>

  <!-- Auth Container -->
  <div id="authContainer" class="auth-container">
    <!-- Login Form -->
    <div id="loginForm">
      <div class="auth-header">
        <h2>🐧 PenguinBudget</h2>
        <p>Your smart finance companion</p>
      </div>

      <div id="loginError" class="alert alert-error hidden"></div>
      <div id="loginSuccess" class="alert alert-success hidden"></div>

      <form onsubmit="handleLogin(event)">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="your@email.com" required>
        </div>

        <div class="form-group">
          <label for="loginPassword">Password</label>
          <div style="position: relative;">
            <input type="password" id="loginPassword" placeholder="Enter password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
              👁️
            </button>
          </div>
        </div>

        <button type="submit" class="btn-primary" id="loginBtn">Login</button>
      </form>

      <div style="text-align: center; margin-top: 30px; padding-top: 30px; border-top: 1px solid var(--border);">
        <p style="color: var(--off-white); opacity: 0.7;">New to PenguinBudget?</p>
        <a href="#" onclick="showSignup()" style="color: var(--gold); text-decoration: none; font-weight: 600;">Create Account</a>
      </div>
    </div>

    <!-- Signup Form -->
    <div id="signupForm" class="hidden">
      <div class="auth-header">
        <h2>🚀 Join PenguinBudget</h2>
        <p>Start your financial journey</p>
      </div>

      <div id="signupError" class="alert alert-error hidden"></div>
      <div id="signupSuccess" class="alert alert-success hidden"></div>

      <form onsubmit="handleSignup(event)">
        <div class="form-group">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" placeholder="your@email.com" required>
        </div>

        <div class="form-group">
          <label for="signupPassword">Password</label>
          <div style="position: relative;">
            <input type="password" id="signupPassword" placeholder="Min 6 characters" required minlength="6">
            <button type="button" class="password-toggle" onclick="togglePassword('signupPassword')">
              👁️
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="signupPasswordConfirm">Confirm Password</label>
          <div style="position: relative;">
            <input type="password" id="signupPasswordConfirm" placeholder="Re-enter password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('signupPasswordConfirm')">
              👁️
            </button>
          </div>
        </div>

        <button type="submit" class="btn-primary" id="signupBtn">Create Account</button>
      </form>

      <div style="text-align: center; margin-top: 30px; padding-top: 30px; border-top: 1px solid var(--border);">
        <p style="color: var(--off-white); opacity: 0.7;">Already have an account?</p>
        <a href="#" onclick="showLogin()" style="color: var(--gold); text-decoration: none; font-weight: 600;">Login</a>
      </div>
    </div>
  </div>

  <!-- Main App Container -->
  <div id="appContainer" class="container">
    <div class="app-container">
      <div class="header">
        <h1>🐧 PenguinBudget</h1>
        <div class="user-info">
          <span class="user-email" id="userEmail">user@example.com</span>
          <button class="btn-secondary" onclick="logout()" style="width: auto;">Logout</button>
        </div>
      </div>

      <!-- Navigation Tabs -->
      <div class="nav-tabs">
        <button class="nav-tab active" onclick="switchTab('dashboard', event)">📊 Dashboard</button>
        <!-- RENAMED TEXT ONLY -->
        <button class="nav-tab" onclick="switchTab('budget', event)">💰 Budget/Savings</button>
        <button class="nav-tab" onclick="switchTab('recurring', event)">🔄 Recurring</button>
        <button class="nav-tab" onclick="switchTab('analytics', event)">📈 Analytics</button>
      </div>

      <!-- Dashboard Tab -->
      <div id="dashboardTab" class="tab-content active">
        <!-- Main Content Grid -->
        <div class="main-content">
          <!-- Sidebar -->
          <div class="sidebar">
            <h3>Add Transaction</h3>
            <form onsubmit="handleAddTransaction(event)">
              <label>Type</label>
              <div class="type-toggle">
                <button type="button" class="type-btn income" id="incomeBtn" onclick="selectType('income')">💰 Income</button>
                <button type="button" class="type-btn expense active" id="expenseBtn" onclick="selectType('expense')">💸 Expense</button>
              </div>
              <input type="hidden" id="transactionType" value="expense" required>

              <div class="form-group">
                <label for="transactionDescription">Description</label>
                <input type="text" id="transactionDescription" placeholder="What's this for?" required>
              </div>

              <div class="form-group">
                <label for="transactionAmount">Amount</label>
                <input type="number" id="transactionAmount" placeholder="0.00" step="0.01" min="0.01" required>
              </div>

              <div class="form-group">
                <label for="transactionCategory">Category</label>
                <select id="transactionCategory" required>
                  <option value="">Select category</option>
                  <optgroup label="Income">
                    <option value="salary">💼 Salary</option>
                    <option value="investment">📈 Investment</option>
                    <option value="other-income">💰 Other Income</option>
                  </optgroup>
                  <optgroup label="Expenses">
                    <option value="food">🍔 Food & Dining</option>
                    <option value="transportation">🚗 Transportation</option>
                    <option value="shopping">🛍️ Shopping</option>
                    <option value="entertainment">🎬 Entertainment</option>
                    <option value="bills">📄 Bills & Utilities</option>
                    <option value="healthcare">🏥 Healthcare</option>
                    <option value="education">📚 Education</option>
                    <option value="other-expense">📦 Other</option>
                  </optgroup>
                </select>
              </div>

              <button type="submit" class="btn-purple">Add Transaction</button>
            </form>
          </div>

          <!-- Content Area -->
          <div class="content">
            <div class="budget-summary">
              <div class="summary-card income">
                <h3>Total Income</h3>
                <div class="amount" id="totalIncome">$0.00</div>
              </div>
              <div class="summary-card expense">
                <h3>Total Expenses</h3>
                <div class="amount" id="totalExpenses">$0.00</div>
              </div>
              <div class="summary-card">
                <h3>Net Balance</h3>
                <div class="amount" id="balance">$0.00</div>
                <div id="rolloverNote" class="rollover-note"></div> <!-- NEW -->
              </div>
            </div>

            <div class="transactions">
              <div class="transactions-header">
                <h3>Recent Transactions</h3>
                <div class="filter-buttons">
                  <button class="filter-btn active" onclick="filterTransactions('all', event)">All</button>
                  <button class="filter-btn" onclick="filterTransactions('income', event)">Income</button>
                  <button class="filter-btn" onclick="filterTransactions('expense', event)">Expenses</button>
                </div>
              </div>
              <div id="transactionsList">
                <div class="empty-state">
                  <div class="empty-state-icon">📝</div>
                  <h4>No transactions yet</h4>
                  <p>Add your first transaction to get started</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recurring Tab -->
      <div id="recurringTab" class="tab-content">
        <div style="padding: 30px;">
          <div class="recurring-section">
            <div class="recurring-header">
              <h4>Recurring Transactions</h4>
              <button class="add-recurring-btn" onclick="openRecurringModal()">+ Add Recurring</button>
            </div>
            <div id="recurringList">
              <div class="empty-state"><p>No recurring transactions yet</p></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Analytics Tab -->
      <div id="analyticsTab" class="tab-content">
        <div class="charts-container">
          <div class="chart-card">
            <h3>Financial Overview</h3>
            <div class="chart-controls">
              <button class="chart-control-btn active" onclick="updateChartPeriod('week', event)">Week</button>
              <button class="chart-control-btn" onclick="updateChartPeriod('month', event)">Month</button>
              <button class="chart-control-btn" onclick="updateChartPeriod('year', event)">Year</button>
            </div>
            <canvas id="financeChart"></canvas>
          </div>
          <div class="chart-card">
            <h3>Category Breakdown</h3>
            <canvas id="categoryChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Budget Tab -->
      <div id="budgetTab" class="tab-content">
        <div style="padding: 30px;">
          <!-- Budget Overview Cards -->
          <div class="budget-overview">
            <div class="budget-card">
              <div class="budget-card-header">
                <h4>📊 Monthly Budget</h4>
                <button class="edit-budget-btn" onclick="openBudgetModal()">Edit</button>
              </div>
              <div class="budget-amount" id="budgetRemaining">Not Set</div>
              <div class="budget-label">Remaining This Month</div>
              <div class="budget-progress">
                <div class="budget-progress-bar" id="budgetBar"></div>
              </div>
            </div>

            <div class="budget-card">
              <div class="budget-card-header">
                <h4>💸 This Month</h4>
              </div>
              <div class="budget-amount expense" id="monthlyExpenses">$0.00</div>
              <div class="budget-label">Total Expenses</div>
            </div>

            <div class="budget-card">
              <div class="budget-card-header">
                <h4>🏦 Savings</h4>
                <button class="edit-budget-btn" onclick="openSavingsModal()">Edit</button>
              </div>
              <div class="budget-amount income" id="totalSavings">$0.00</div>
              <!-- RENAMED LABEL ONLY -->
              <div class="budget-label">Total Saved</div>
              <div class="budget-toggle">
                <label class="toggle-label">
                  <input type="checkbox" id="autoSavingsToggle" onchange="toggleAutoSavings(this)">
                  <span class="toggle-slider"></span>
                  <!-- RENAMED TOGGLE TEXT ONLY -->
                  <span class="toggle-text">Auto-add to savings (from net balance)</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Recent Expenses in Budget Tab -->
          <div class="budget-transactions">
            <h3>Recent Expenses</h3>
            <div id="budgetTransactionsList">
              <div class="empty-state"><p>No transactions yet</p></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recurring Transaction Modal -->
      <div id="recurringModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Recurring Transaction</h3>
            <button class="modal-close" onclick="closeRecurringModal()">×</button>
          </div>
          <form onsubmit="handleAddRecurring(event)">
            <label>Type</label>
            <div class="type-toggle">
              <button type="button" class="type-btn income" id="recurringIncomeBtn" onclick="selectRecurringType('income')">💰 Income</button>
              <button type="button" class="type-btn expense active" id="recurringExpenseBtn" onclick="selectRecurringType('expense')">💸 Expense</button>
            </div>
            <input type="hidden" id="recurringType" value="expense" required>

            <div class="form-group">
              <label for="recurringDescription">Description</label>
              <input type="text" id="recurringDescription" placeholder="e.g., Netflix, Salary" required>
            </div>

            <div class="form-group">
              <label for="recurringAmount">Amount</label>
              <input type="number" id="recurringAmount" placeholder="0.00" step="0.01" min="0.01" required>
            </div>

            <div class="form-group">
              <label>Frequency</label>
              <div class="frequency-options">
                <button type="button" class="frequency-btn active" onclick="selectFrequency('weekly', event)">Weekly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('biweekly', event)">Bi-weekly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('monthly', event)">Monthly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('yearly', event)">Yearly</button>
              </div>
              <input type="hidden" id="recurringFrequency" value="weekly" required>
            </div>

            <div class="form-group" id="dayOfWeekGroup">
              <label for="recurringDay">Day of Week</label>
              <select id="recurringDay">
                <option value="">Select day</option>
                <option value="sunday">Sunday</option>
                <option value="monday">Monday</option>
                <option value="tuesday">Tuesday</option>
                <option value="wednesday">Wednesday</option>
                <option value="thursday">Thursday</option>
                <option value="friday">Friday</option>
                <option value="saturday">Saturday</option>
              </select>
            </div>

            <div class="form-group">
              <label for="recurringCategory">Category</label>
              <select id="recurringCategory" required>
                <option value="">Select category</option>
                <option value="salary">💼 Salary</option>
                <option value="investment">📈 Investment</option>
                <option value="other-income">💰 Other Income</option>
                <option value="bills">📄 Bills & Utilities</option>
                <option value="entertainment">🎬 Entertainment</option>
                <option value="subscriptions">📱 Subscriptions</option>
                <option value="other-expense">📦 Other</option>
              </select>
            </div>

            <button type="submit" class="btn-purple" style="width: 100%;">Add Recurring Transaction</button>
          </form>
        </div>
      </div>

      <!-- Budget Setting Modal -->
      <div id="budgetModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Set Monthly Budget</h3>
            <button class="modal-close" onclick="closeBudgetModal()">×</button>
          </div>
          <form onsubmit="handleSetBudget(event)">
            <div class="form-group">
              <label for="monthlyBudgetLimit">Monthly Spending Limit</label>
              <input type="number" id="monthlyBudgetLimit" placeholder="0.00" step="0.01" min="0.01" required>
            </div>
            <button type="submit" class="btn-purple" style="width: 100%;">Set Budget</button>
          </form>
        </div>
      </div>

      <!-- Savings Update Modal -->
      <div id="savingsModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Update Savings</h3>
            <button class="modal-close" onclick="closeSavingsModal()">×</button>
          </div>
          <form onsubmit="handleUpdateSavings(event)">
            <div class="form-group">
              <label for="savingsAmount">Total Savings Amount</label>
              <input type="number" id="savingsAmount" placeholder="0.00" step="0.01" min="0" required>
              <small style="color: var(--gold); opacity: 0.7;">Enter your current total savings</small>
            </div>
            <button type="submit" class="btn-purple" style="width: 100%;">Update Savings</button>
          </form>
        </div>
      </div>

    </div>
  </div>

  <!-- Link to your app logic -->
  <script type="module" src="app.js"></script>
</body>
</html>
