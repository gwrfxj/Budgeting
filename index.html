<!-- /Users/andrewgui/Downloads/Web Development/Penguin Budget/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
  />
  <title>PenguinBudget - Smart Personal Finance Tracker</title>

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="bg-animation" aria-hidden="true"></div>

  <!-- Cute Penguin Decorations -->
  <div class="penguin-corner top-left" aria-hidden="true">
    <svg class="penguin-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="70" rx="25" ry="28" fill="#1a1a1a"/>
      <ellipse cx="50" cy="70" rx="20" ry="23" fill="#ffffff"/>
      <ellipse cx="50" cy="40" rx="20" ry="22" fill="#1a1a1a"/>
      <ellipse cx="42" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="58" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="42" cy="39" rx="2" ry="3" fill="#000000"/>
      <ellipse cx="58" cy="39" rx="2" ry="3" fill="#000000"/>
      <polygon points="50,45 47,50 53,50" fill="#FFD700"/>
      <ellipse cx="35" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(-20 35 60)"/>
      <ellipse cx="65" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(20 65 60)"/>
      <ellipse cx="45" cy="85" rx="6" ry="4" fill="#FFD700"/>
      <ellipse cx="55" cy="85" rx="6" ry="4" fill="#FFD700"/>
    </svg>
  </div>

  <div class="penguin-corner bottom-right" aria-hidden="true">
    <svg class="penguin-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="70" rx="25" ry="28" fill="#1a1a1a"/>
      <ellipse cx="50" cy="70" rx="20" ry="23" fill="#ffffff"/>
      <ellipse cx="50" cy="40" rx="20" ry="22" fill="#1a1a1a"/>
      <ellipse cx="42" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="58" cy="38" rx="4" ry="5" fill="#ffffff"/>
      <ellipse cx="42" cy="39" rx="2" ry="3" fill="#000000"/>
      <ellipse cx="58" cy="39" rx="2" ry="3" fill="#000000"/>
      <polygon points="50,45 47,50 53,50" fill="#FFD700"/>
      <ellipse cx="35" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(-20 35 60)"/>
      <ellipse cx="65" cy="60" rx="8" ry="15" fill="#1a1a1a" transform="rotate(20 65 60)"/>
      <ellipse cx="45" cy="85" rx="6" ry="4" fill="#FFD700"/>
      <ellipse cx="55" cy="85" rx="6" ry="4" fill="#FFD700"/>
    </svg>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" role="alert" aria-live="polite">
    <div class="loading-content">
      <div class="loading-spinner" aria-hidden="true"></div>
      <p style="color: var(--gold);">Loading...</p>
    </div>
  </div>

  <!-- Auth Container -->
  <div id="authContainer" class="auth-container" role="main">
    <!-- Login Form -->
    <div id="loginForm">
      <div class="auth-header">
        <h2>ğŸ§ PenguinBudget</h2>
        <p>Your smart finance companion</p>
      </div>

      <div id="loginError" class="alert alert-error hidden" role="alert"></div>
      <div id="loginSuccess" class="alert alert-success hidden" role="status"></div>

      <form onsubmit="handleLogin(event)" autocomplete="on">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="your@email.com"
                 autocomplete="email" inputmode="email" required>
        </div>

        <div class="form-group">
          <label for="loginPassword">Password</label>
          <div style="position: relative;">
            <input type="password" id="loginPassword" placeholder="Enter password"
                   autocomplete="current-password" required>
            <button type="button" class="password-toggle" aria-label="Toggle password visibility"
                    onclick="togglePassword('loginPassword')">ğŸ‘ï¸</button>
          </div>
        </div>

        <button type="submit" class="btn-primary" id="loginBtn">Login</button>
      </form>

      <div style="text-align: center; margin-top: 30px; padding-top: 30px; border-top: 1px solid var(--border);">
        <p style="color: var(--off-white); opacity: 0.7;">New to PenguinBudget?</p>
        <a href="#" onclick="showSignup()" style="color: var(--gold); text-decoration: none; font-weight: 600;">Create Account</a>
      </div>
    </div>

    <!-- Signup Form -->
    <div id="signupForm" class="hidden">
      <div class="auth-header">
        <h2>ğŸš€ Join PenguinBudget</h2>
        <p>Start your financial journey</p>
      </div>

      <div id="signupError" class="alert alert-error hidden" role="alert"></div>
      <div id="signupSuccess" class="alert alert-success hidden" role="status"></div>

      <form onsubmit="handleSignup(event)" autocomplete="on">
        <div class="form-group">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" placeholder="your@email.com"
                 autocomplete="email" inputmode="email" required>
        </div>

        <div class="form-group">
          <label for="signupPassword">Password</label>
          <div style="position: relative;">
            <input type="password" id="signupPassword" placeholder="Min 6 characters"
                   autocomplete="new-password" minlength="6" required>
            <button type="button" class="password-toggle" aria-label="Toggle password visibility"
                    onclick="togglePassword('signupPassword')">ğŸ‘ï¸</button>
          </div>
        </div>

        <div class="form-group">
          <label for="signupPasswordConfirm">Confirm Password</label>
          <div style="position: relative;">
            <input type="password" id="signupPasswordConfirm" placeholder="Re-enter password"
                   autocomplete="new-password" required>
            <button type="button" class="password-toggle" aria-label="Toggle password visibility"
                    onclick="togglePassword('signupPasswordConfirm')">ğŸ‘ï¸</button>
          </div>
        </div>

        <button type="submit" class="btn-primary" id="signupBtn">Create Account</button>
      </form>

      <div style="text-align: center; margin-top: 30px; padding-top: 30px; border-top: 1px solid var(--border);">
        <p style="color: var(--off-white); opacity: 0.7;">Already have an account?</p>
        <a href="#" onclick="showLogin()" style="color: var(--gold); text-decoration: none; font-weight: 600;">Login</a>
      </div>
    </div>
  </div>

  <!-- Main App Container -->
  <div id="appContainer" class="container">
    <div class="app-container">
      <div class="header">
        <h1>ğŸ§ PenguinBudget</h1>
        <div class="user-info">
          <span class="user-email" id="userEmail">user@example.com</span>
          <button class="btn-secondary" onclick="logout()" style="width: auto;">Logout</button>
        </div>
      </div>

      <!-- Navigation Tabs -->
      <nav class="nav-tabs" aria-label="Primary">
        <button class="nav-tab active" onclick="switchTab('dashboard', event)">ğŸ“Š Dashboard</button>
        <button class="nav-tab" onclick="switchTab('budget', event)">ğŸ’° Budget/Savings</button>
        <button class="nav-tab" onclick="switchTab('recurring', event)">ğŸ”„ Recurring</button>
        <button class="nav-tab" onclick="switchTab('analytics', event)">ğŸ“ˆ Analytics</button>
      </nav>

      <!-- Dashboard Tab -->
      <section id="dashboardTab" class="tab-content active" aria-labelledby="Dashboard">
        <div class="main-content">
          <!-- Sidebar -->
          <aside class="sidebar">
            <h3>Add Transaction</h3>
            <form onsubmit="handleAddTransaction(event)" autocomplete="off" novalidate>
              <label>Type</label>
              <div class="type-toggle" role="group" aria-label="Transaction type">
                <button type="button" class="type-btn income" id="incomeBtn" onclick="selectType('income')">ğŸ’° Income</button>
                <button type="button" class="type-btn expense active" id="expenseBtn" onclick="selectType('expense')">ğŸ’¸ Expense</button>
              </div>
              <input type="hidden" id="transactionType" value="expense" required>

              <div class="form-group">
                <label for="transactionDescription">Description</label>
                <input type="text" id="transactionDescription" placeholder="What's this for?"
                       inputmode="text" autocomplete="off" autocapitalize="sentences" required>
              </div>

              <div class="form-group">
                <label for="transactionAmount">Amount</label>
                <input type="number" id="transactionAmount" placeholder="0.00"
                      step="0.01" min="0.01" inputmode="decimal" required>
                <small id="amountHint" class="input-hint" aria-live="polite">Enter an amount!</small>
              </div>

              <div class="form-group">
                <label for="transactionCategory">Category</label>
                <select id="transactionCategory" required>
                <option value="" selected disabled hidden>Select category</option>
                  <optgroup label="Income">
                    <option value="salary">ğŸ’¼ Salary</option>
                    <option value="investment">ğŸ“ˆ Investment</option>
                    <option value="business">ğŸ¢ Business</option><!-- NEW -->
                    <option value="other-income">ğŸ’° Other Income</option>
                  </optgroup>
                  <optgroup label="Expenses">
                    <option value="food">ğŸ” Food & Dining</option>
                    <option value="transportation">ğŸš— Transportation</option>
                    <option value="shopping">ğŸ›ï¸ Shopping</option>
                    <option value="entertainment">ğŸ¬ Entertainment</option>
                    <option value="bills">ğŸ“„ Bills & Utilities</option>
                    <option value="healthcare">ğŸ¥ Healthcare</option>
                    <option value="education">ğŸ“š Education</option>
                    <option value="other-expense">ğŸ“¦ Other</option>
                  </optgroup>
                </select>
              </div>

                <button type="submit" class="btn-purple" id="addTxBtn" disabled>Add Transaction</button>
            </form>
          </aside>

          <!-- Content Area -->
          <div class="content">
            <div class="budget-summary">
              <div class="summary-card income">
                <h3>Total Income</h3>
                <div class="amount" id="totalIncome">$0.00</div>
              </div>
              <div class="summary-card expense">
                <h3>Total Expenses</h3>
                <div class="amount" id="totalExpenses">$0.00</div>
              </div>
              <div class="summary-card">
                <h3>Net Balance</h3>
                <div class="amount" id="balance">$0.00</div>
                <div id="rolloverNote" class="rollover-note" aria-live="polite"></div>
              </div>
            </div>

            <div class="transactions">
              <div class="transactions-header">
                <h3>Recent Transactions</h3>
                <div class="filter-buttons" role="tablist" aria-label="Transaction filters">
                  <button class="filter-btn active" onclick="filterTransactions('all', event)">All</button>
                  <button class="filter-btn" onclick="filterTransactions('income', event)">Income</button>
                  <button class="filter-btn" onclick="filterTransactions('expense', event)">Expenses</button>
                </div>
              </div>
              <div id="transactionsList">
                <div class="empty-state">
                  <div class="empty-state-icon">ğŸ“</div>
                  <h4>No transactions yet</h4>
                  <p>Add your first transaction to get started</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recurring Tab -->
      <section id="recurringTab" class="tab-content" aria-labelledby="Recurring">
        <div style="padding: 30px;">
          <div class="recurring-section">
            <div class="recurring-header">
              <h4>Recurring Transactions</h4>
              <button class="add-recurring-btn" onclick="openRecurringModal()">+ Add Recurring</button>
            </div>
            <div id="recurringList">
              <div class="empty-state"><p>No recurring transactions yet</p></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Analytics Tab -->
      <section id="analyticsTab" class="tab-content" aria-labelledby="Analytics">
        <div class="charts-container">
          <div class="chart-card">
            <h3>Financial Overview</h3>
            <div class="chart-controls">
              <button class="chart-control-btn active" onclick="updateChartPeriod('week', event)">Week</button>
              <button class="chart-control-btn" onclick="updateChartPeriod('month', event)">Month</button>
              <button class="chart-control-btn" onclick="updateChartPeriod('year', event)">Year</button>
            </div>
            <canvas id="financeChart"></canvas>
          </div>
          <div class="chart-card">
            <h3>Category Breakdown</h3>
            <canvas id="categoryChart"></canvas>
          </div>
        </div>
      </section>

      <!-- Budget Tab -->
      <section id="budgetTab" class="tab-content" aria-labelledby="Budget/Savings">
        <div style="padding: 30px;">
          <!-- Budget Overview Cards -->
          <div class="budget-overview">
            <!-- Monthly Budget -->
            <div class="budget-card">
              <div class="budget-card-header">
                <h4>ğŸ“Š Monthly Budget</h4>
                <button class="edit-budget-btn" onclick="openBudgetModal()">Edit</button>
              </div>
              <div class="budget-amount" id="budgetRemaining">Not Set</div>
              <div class="budget-label">Remaining This Month</div>
              <div class="budget-progress">
                <div class="budget-progress-bar" id="budgetBar"></div>
              </div>
            </div>

            <!-- This Month Expenses -->
            <div class="budget-card">
              <div class="budget-card-header">
                <h4>ğŸ’¸ This Month</h4>
              </div>
              <div class="budget-amount expense" id="monthlyExpenses">$0.00</div>
              <div class="budget-label">Total Expenses</div>
            </div>

            <!-- Savings (with Goal) -->
            <div class="budget-card">
              <div class="budget-card-header">
                <h4>ğŸ¦ Savings</h4> 
                <div style="display:flex; gap:8px; align-items:center;">
                  <button class="edit-budget-btn" onclick="openSavingsModal()">Edit</button>
                  <button class="edit-budget-btn" onclick="openSavingsGoalModal()">Edit Goal</button><!-- NEW -->
                </div>
              </div>

                <div class="budget-amount income" id="totalSavings">$0.00</div>
                <div class="budget-label">Total Saved</div>
                <div class="budget-label"><strong>Savings Goal: <span id="savingsGoalDisplay">$0.00</span></strong></div>

              <div class="budget-toggle">
                <label class="toggle-label">
                  <input type="checkbox" id="autoSavingsToggle" onchange="toggleAutoSavings(this)">
                  <span class="toggle-slider"></span>
                  <span class="toggle-text">Auto-add to savings (MONTHLY, from net balance)</span>
                </label>
              </div>
            </div>

            <!-- Yearly Resets (NEW) -->
            <div class="budget-card">
              <div class="budget-card-header">
                <h4>ğŸ—“ï¸ Yearly Resets</h4>
              </div>

              <div class="budget-toggle" style="margin-top:8px;">
                <label class="toggle-label" title="Zero totals on Jan 1 to view clean yearly totals">
                  <input type="checkbox" id="yearResetTxToggle" onchange="toggleYearResetTransactions(this)">
                  <span class="toggle-slider"></span>
                  <span class="toggle-text">Reset Income/Expenses at year end</span>
                </label>
              </div>

              <div class="budget-toggle" style="margin-top:8px;">
                <label class="toggle-label" title="Zero savings on Jan 1 for yearly goal tracking">
                  <input type="checkbox" id="yearResetSavingsToggle" onchange="toggleYearResetSavings(this)">
                  <span class="toggle-slider"></span>
                  <span class="toggle-text">Reset Savings at year end</span>
                </label>
              </div>

              <small style="opacity:.7;display:block;margin-top:10px;">
                When enabled, values are zeroed automatically at the start of a new calendar year.
              </small>
            </div>
          </div>

          <!-- Recent Expenses in Budget Tab -->
          <div class="budget-transactions">
            <h3>Recent Expenses</h3>
            <div id="budgetTransactionsList">
              <div class="empty-state"><p>No transactions yet</p></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Recurring Transaction Modal -->
      <div id="recurringModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="recurringModalTitle">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="recurringModalTitle">Add Recurring Transaction</h3>
            <button class="modal-close" onclick="closeRecurringModal()" aria-label="Close">Ã—</button>
          </div>
          <form onsubmit="handleAddRecurring(event)" autocomplete="off">
            <label>Type</label>
            <div class="type-toggle" role="group" aria-label="Recurring type">
              <button type="button" class="type-btn income" id="recurringIncomeBtn" onclick="selectRecurringType('income')">ğŸ’° Income</button>
              <button type="button" class="type-btn expense active" id="recurringExpenseBtn" onclick="selectRecurringType('expense')">ğŸ’¸ Expense</button>
            </div>
            <input type="hidden" id="recurringType" value="expense" required>

            <div class="form-group">
              <label for="recurringDescription">Description</label>
              <input type="text" id="recurringDescription" placeholder="e.g., Netflix, Salary"
                     inputmode="text" required>
            </div>

            <div class="form-group">
              <label for="recurringAmount">Amount</label>
              <input type="number" id="recurringAmount" placeholder="0.00" step="0.01" min="0.01"
                     inputmode="decimal" required>
            </div>

            <div class="form-group">
              <label>Frequency</label>
              <div class="frequency-options">
                <button type="button" class="frequency-btn active" onclick="selectFrequency('weekly', event)">Weekly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('biweekly', event)">Bi-weekly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('monthly', event)">Monthly</button>
                <button type="button" class="frequency-btn" onclick="selectFrequency('yearly', event)">Yearly</button>
              </div>
              <input type="hidden" id="recurringFrequency" value="weekly" required>
            </div>

            <div class="form-group" id="dayOfWeekGroup">
              <label for="recurringDay">Day of Week</label>
              <select id="recurringDay">
                <option value="">Select day</option>
                <option value="sunday">Sunday</option>
                <option value="monday">Monday</option>
                <option value="tuesday">Tuesday</option>
                <option value="wednesday">Wednesday</option>
                <option value="thursday">Thursday</option>
                <option value="friday">Friday</option>
                <option value="saturday">Saturday</option>
              </select>
            </div>

            <div class="form-group">
              <label for="recurringCategory">Category</label>
              <select id="recurringCategory" required>
                <option value="">Select category</option>
                <option value="salary">ğŸ’¼ Salary</option>
                <option value="investment">ğŸ“ˆ Investment</option>
                <option value="business">ğŸ¢ Business</option><!-- NEW -->
                <option value="other-income">ğŸ’° Other Income</option>
                <option value="bills">ğŸ“„ Bills & Utilities</option>
                <option value="entertainment">ğŸ¬ Entertainment</option>
                <option value="subscriptions">ğŸ“± Subscriptions</option>
                <option value="other-expense">ğŸ“¦ Other</option>
              </select>
            </div>

            <button type="submit" class="btn-purple" style="width: 100%;">Add Recurring Transaction</button>
          </form>
        </div>
      </div>

      <!-- Budget Setting Modal -->
      <div id="budgetModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="budgetModalTitle">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="budgetModalTitle">Set Monthly Budget</h3>
            <button class="modal-close" onclick="closeBudgetModal()" aria-label="Close">Ã—</button>
          </div>
          <form onsubmit="handleSetBudget(event)" autocomplete="off">
            <div class="form-group">
              <label for="monthlyBudgetLimit">Monthly Spending Limit</label>
              <input type="number" id="monthlyBudgetLimit" placeholder="0.00" step="0.01" min="0.01"
                     inputmode="decimal" required>
            </div>
            <button type="submit" class="btn-purple" style="width: 100%;">Set Budget</button>
          </form>
        </div>
      </div>

      <!-- Savings Update Modal -->
      <div id="savingsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="savingsModalTitle">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="savingsModalTitle">Update Savings</h3>
            <button class="modal-close" onclick="closeSavingsModal()" aria-label="Close">Ã—</button>
          </div>
          <form onsubmit="handleUpdateSavings(event)" autocomplete="off">
            <div class="form-group">
              <label for="savingsAmount">Total Savings Amount</label>
              <input type="number" id="savingsAmount" placeholder="0.00"
                     step="0.01" min="0" inputmode="decimal" required>
              <small style="color: var(--gold); opacity: 0.7;">Enter your current total savings</small>
            </div>
            <button type="submit" class="btn-purple" style="width: 100%;">Update Savings</button>
          </form>
        </div>
      </div>

      <!-- Savings Goal Modal (NEW) -->
      <div id="savingsGoalModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="savingsGoalModalTitle">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="savingsGoalModalTitle">Set Savings Goal</h3>
            <button class="modal-close" onclick="closeSavingsGoalModal()" aria-label="Close">Ã—</button>
          </div>
          <form onsubmit="handleUpdateSavingsGoal(event)" autocomplete="off">
            <div class="form-group">
              <label for="savingsGoalInput">Savings Goal Amount</label>
              <input type="number" id="savingsGoalInput" placeholder="0.00"
                     step="0.01" min="0" inputmode="decimal" required>
              <small style="color: var(--gold); opacity: 0.7;">Set your yearly savings goal</small>
            </div>
            <button type="submit" class="btn-purple" style="width: 100%;">Save Goal</button>
          </form>
        </div>
      </div>
      <!-- /Savings Goal Modal -->

    </div>
  </div>

  <!-- App Logic -->
  <script type="module" src="app.js"></script>

  <!-- Stubs for new modal open/close (non-breaking if not yet implemented) -->
  <script>
    // keep UI responsive if handlers arenâ€™t wired yet
    window.openSavingsGoalModal = () => document.getElementById('savingsGoalModal')?.classList.add('active');
    window.closeSavingsGoalModal = () => document.getElementById('savingsGoalModal')?.classList.remove('active');

    // these will be implemented in app.js next
    window.toggleYearResetTransactions = (el) => {};
    window.toggleYearResetSavings = (el) => {};
    window.handleUpdateSavingsGoal = (e) => { e.preventDefault(); };
  </script>
  <div id="toast" class="toast" aria-live="polite"></div>
</body>
</html>
